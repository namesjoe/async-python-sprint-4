### Документация:
обзор функциональности приложения, описание API-конечных точек и примеры запросов и ответов.

### Обзор
Приложение предоставляет функциональность сокращения, управления и перенаправления URL-адресов.

приложение написано с использованием 
- FastAPI ( разработка API)
- SQLAlchemy (работы с базой данных)
- Pydantic (валидация данных)

#### Структура

app.py: основной файл приложения, он отвечает за основную структуру FastAPI-приложения и эндпойнты.

logger.py: модуль логирование

migrations: Директория в которой содержатся скрипты миграции для управления изменениями схемы БД.

src: Директория с основным кодом приложения.

core: Директория для размещения основных компонентов и настроек проекта

api: субдериктория, содержащая код, связанный с API.

v1: субдериктория, содержащая эндпойнты API для разных функций.

#
config.py: Конфиг, содержащий настройки сервера.

security.py: Конфиг, содержащий настройки безопасности сервера.

settings.py: Конфиг содержащий настройки сервера.

db: Подпакет, содержащий код, связанный с базой.

database.py: скрипт с методами обращения к базе.

db_setup.py: Код настройки БД, включая создание сессии. 

models: Подпакет, содержащий модели SQLAlchemy для таблиц базы данных.

schemas: Подпакет, содержащий схемы Pydantic для данных запросов и ответов API.

services: Подпакет для дополнительных сервисов (при необходимости).

utils: Подпакет, содержащий утилитарные функции для разных задач.

tests: Каталог, содержащий модули юнит-тестов для функциональностей приложения.

init.py: Пустой файл, указывающий на то, что каталоги являются частью пакетов Python.

#### Установка и Запуск
Склонируйте репозиторий с приложением.

Установите зависимости, выполнив pip install -r requirements.txt.

Настройте конфигурационные параметры в config.py (по необходимости).
Создайте и настройте базу данных с помощью миграций из каталога migrations:

alembic upgrade head
Запустить uvicorn app:app --host 0.0.0.0 --port 8080 --reload

#### API Конечные Точки

`GET /api/v1/`

Описание: Получение корневого сообщения.

Пример запроса: `GET /api/v1/`

Пример ответа:

`{
  "message": "Short link here!"
}`


`POST /api/v1/shorten/`

Описание: Создание сокращенного URL.

Пример запроса:

`POST /api/v1/shorten/
{
  "url": "http://example.com"
}`
Пример ответа:

`{
  "short_url": "http://0.0.0.0:8080/short_url_id"
}`

`GET /api/v1/{short_url_id}`

Описание: Перенаправление по сокращенному URL.

Пример запроса: `GET /api/v1/short_url_id`


`DELETE /api/v1/{short_url_id}`

Описание: Удаление сокращенного URL.

Пример запроса: `DELETE /api/v1/short_url_id`

Пример ответа:

`{
  "message": "URL deleted successfully"
}`


`GET /api/v1/{short_url_id}/status`

Описание: Получение статуса сокращенного URL.

Пример запроса: `GET /api/v1/short_url_id/status`

Пример ответа:

`{
  "total_access_count": 10,
  "access_info": [...]
}`



# Проектное задание четвёртого спринта

Спроектируйте и реализуйте сервис для создания сокращённой формы передаваемых URL и анализа активности их использования.

Кроме этого, выберите из списка дополнительные требования и тоже реализуйте их. У каждого задания есть определённая сложность, от которой зависит количество баллов. Вам необходимо выбрать такое количество заданий, чтобы общая сумма баллов была больше 4. Выбор заданий никак не ограничен: можно выбрать все простые или одно среднее и два простых, или одно продвинутое, или решить все.

## Описание задания

Реализовать `http`-сервис, который обрабатывает поступающие запросы. Сервер стартует по адресу `http://127.0.0.1:8080` (значение по умолчанию, можно изменять).

<details>
<summary> Список возможных эндпойнтов (можно изменять) </summary>

1. Получение сокращённого варианта URL.

```python
POST /
```

Метод принимающий в теле запроса строку URL для сокращения и возвращает ответ с кодом `201`.

2. Возвращает оригинальный URL.

```python
GET /<shorten-url-id>
```

Метод принимает в качестве параметра идентификатор сокращённого URL и возвращает ответ с кодом `307` и оригинальным URL в заголовке `Location`.

3. Вернуть статус использования URL.

```python
GET /<shorten-url-id>/status?[full-info]&[max-result=10]&[offset=0]
```

Метод принимает в качестве параметра идентификатор сокращённого URL и возвращает информацию о количестве переходов,
совершенных по ссылке.

Ответ может содержать как общее количество совершенных переходов, так и дополнительная детальная информация о каждом
переходе (наличие **query**-параметра **full-info** и параметров пагинации):
- дата и время перехода/использования ссылки;
- информация о клиенте, выполнившем запрос;

</details>


## Дополнительные требования (отметьте [Х] выбранные пункты):

- [x] (1 балл) Реализуйте метод `GET /ping`, который возвращает информацию о статусе доступности БД.
- [x] (1 балл) Реализуйте возможность «удаления» сохранённого URL. Запись должна остаться, но помечаться как удалённая. При попытке получения полного URL возвращать ответ с кодом `410 Gone`.
- [ ] (2 балла) Реализуйте middlware, блокирующий доступ к сервису из запрещённых подсетей (black list).
- [ ] (2 балла) Реализуйте возможность передавать ссылки пачками (batch upload).

<details>
<summary> Описание изменений </summary>

- Метод `POST /shorten` принимает в теле запроса список URL в формате:

```python
[
    {
        "original-url": "<URL-for-shorten>"
    },
    ...
]

```
... и возвращает данные в следующем формате:

```python
[
    {
        "short-id": "<shoten-id>",
        "short-url": "http://...",
    },
    ...
]
```
</details>


- [x] (3 балла) Реализуйте взаимодействие с сервисом авторизованного пользователя. Пользователь может создавать как приватные, так и публичные ссылки или изменять видимость ссылок. Вызов метода `GET /user/status` возвращает все созданные ранее ссылки в формате:

```
[
    {
        "short-id": "<text-id>",
        "short-url": "http://...",
        "original-url": "http://...",
        "type": "<public|private>"
    },
    ...
]
```

- [ ] **(5 баллов) Реализуйте кастомное взаимодействия с БД. Необходимо учесть возможность работы с транзакциями.


## Требования к решению

1. Используйте фреймворк FastAPI. В качестве СУБД используйте PostgreSQL (не ниже 10 версии).
2. Используйте концепции ООП.
3. Предусмотрите обработку исключительных ситуаций.
4. Приведите стиль кода в соответствие pep8, flake8, mypy.
5. Логируйте результаты действий.
6. Покройте написанный код тестами.
